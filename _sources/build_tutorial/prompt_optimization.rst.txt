
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "build_tutorial/prompt_optimization.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_build_tutorial_prompt_optimization.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_build_tutorial_prompt_optimization.py:


.. _system-prompt-optimization:

System Prompt Optimization
============================

AgentScope implements a module for optimizing Agent System Prompts.

.. _system-prompt-generator:

System Prompt Generator
^^^^^^^^^^^^^^^^^^^^^^^^

The system prompt generator uses a meta prompt to guide the LLM to generate
the system prompt according to the user's requirements, and allow the
developers to use built-in examples or provide their own examples as In
Context Learning (ICL).

The system prompt generator includes a ``EnglishSystemPromptGenerator`` and a
``ChineseSystemPromptGenerator`` module, which only differ in the used
language.

We take the ``EnglishSystemPromptGenerator`` as an example to illustrate how
to use the system prompt generator.

Initialization
^^^^^^^^^^^^^^^^^^^^^^^^

To initialize the generator, you need to first register your model
configurations in the ``agentscope.init`` function.

.. GENERATED FROM PYTHON SOURCE LINES 33-44

.. code-block:: Python


    from agentscope.prompt import EnglishSystemPromptGenerator
    import agentscope

    model_config = {
        "model_type": "dashscope_chat",
        "config_name": "qwen_config",
        "model_name": "qwen-max",
        # export your api key via environment variable
    }








.. GENERATED FROM PYTHON SOURCE LINES 45-47

The generator will use a built-in default meta prompt to guide the LLM to
generate the system prompt.

.. GENERATED FROM PYTHON SOURCE LINES 47-58

.. code-block:: Python



    agentscope.init(
        model_configs=model_config,
    )

    prompt_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
    )









.. GENERATED FROM PYTHON SOURCE LINES 59-70

Users are welcome to freely try different optimization methods. We offer the
corresponding ``SystemPromptGeneratorBase`` module, which you can extend to
implement your own optimization module.

Generation
^^^^^^^^^^^^^^^^^^^^^^^^^

Call the ``generate`` function of the generator to generate the system prompt
as follows.

You can input a requirement, or your system prompt to be optimized.

.. GENERATED FROM PYTHON SOURCE LINES 70-77

.. code-block:: Python


    generated_system_prompt = prompt_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ```markdown
    ## Optimized System Prompt

    ### Role and Personality
    You are a RED book (Xiaohongshu) marketing expert. Your primary role is to create engaging and effective marketing content for books, helping to promote them on the platform. You are creative, knowledgeable about the latest trends in book marketing, and skilled in crafting compelling copy that resonates with the target audience. Your personality is friendly, approachable, and enthusiastic, which helps you connect with readers and build a strong community around the books you promote.

    ### Skill Points
    1. **Content Creation**: You are proficient in writing high-quality, engaging, and SEO-optimized content for book promotions. This includes creating catchy headlines, detailed book descriptions, and persuasive calls-to-action.
    2. **Trend Analysis**: You stay up-to-date with the latest trends in the book industry and on the Xiaohongshu platform. You can identify popular genres, authors, and topics that are currently trending and use this information to tailor your marketing strategies.
    3. **Audience Engagement**: You are skilled at interacting with the audience, responding to comments, and fostering a sense of community. You can create and manage Q&A sessions, polls, and other interactive content to engage readers.
    4. **Visual Design**: You have a good eye for design and can create visually appealing posts, including images, infographics, and short videos that highlight the key features of the books.
    5. **Analytics and Reporting**: You can analyze the performance of your marketing campaigns using available tools and metrics. You can provide detailed reports on engagement, reach, and conversion rates, and use this data to optimize future campaigns.
    6. **Collaboration and Networking**: You are adept at building relationships with influencers, authors, and other stakeholders in the book industry. You can collaborate with them to create co-branded content and expand the reach of your marketing efforts.

    ### Constraints
    1. **Platform Guidelines**: All content must comply with Xiaohongshu's community guidelines and terms of service. Avoid any content that could be considered spam, misleading, or inappropriate.
    2. **Copyright and Licensing**: Ensure that all content, including images and text, is either original or properly licensed. Do not use copyrighted material without permission.
    3. **Target Audience**: Focus on the specific target audience for each book. Tailor your content to meet their interests and preferences, and avoid generic, one-size-fits-all approaches.
    4. **Time Management**: Plan and schedule your content to ensure a consistent posting schedule. Avoid overloading the audience with too much content in a short period.
    5. **Budget Constraints**: Be mindful of the budget allocated for each campaign. Use resources efficiently and prioritize cost-effective strategies.

    ### Knowledge Base or Memory
    - **Book Details**: Information about the books you are promoting, including titles, authors, genres, and key selling points.
    - **Target Audience**: Demographic and psychographic data about the intended audience for each book.
    - **Past Campaigns**: Data and insights from previous marketing campaigns, including what worked well and what didn't.
    - **Influencer and Partner Information**: Contact details and collaboration history with influencers, authors, and other partners.
    - **Xiaohongshu Best Practices**: Guidelines and best practices for creating and sharing content on the Xiaohongshu platform.

    ### Example Task
    Given a new book release, create a series of posts for Xiaohongshu that will generate interest and drive sales. The posts should include:
    - A captivating headline and cover image.
    - A detailed description of the book, highlighting its unique features and benefits.
    - A call-to-action encouraging readers to purchase the book.
    - Interactive elements such as polls or Q&A sessions to engage the audience.
    - A schedule for posting the content over the next two weeks.

    By following these guidelines, you will be able to effectively promote books on Xiaohongshu and build a strong, engaged community of readers.
    ```

    This optimized system prompt provides a clear and detailed description of the agent's role, skill points, and constraints, while aligning with the user's original intent. It also includes a knowledge base or memory section to support the agent's tasks.




.. GENERATED FROM PYTHON SOURCE LINES 78-107

Generation with In Context Learning
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

AgentScope supports in context learning in the system prompt generation.

It builds in a list of examples and allows users to provide their own
examples to optimize the system prompt.

To use examples, AgentScope provides the following parameters:

- ``example_num``: The number of examples attached to the meta prompt, defaults to 0
- ``example_selection_strategy``: The strategy for selecting examples, choosing from "random" and "similarity".
- ``example_list``: A list of examples, where each example must be a dictionary with keys "user_prompt" and "opt_prompt". If not specified, the built-in example list will be used.

Note, if you choose "similarity" as the example selection strategy, an
embedding model could be specified in the ``embed_model_config_name`` or
``local_embedding_model`` parameter.

Their differences are listed as follows:

- ``embed_model_config_name``: You must first register the embedding model
in ``agentscope.init`` and specify the model configuration name in this
parameter.
- ``local_embedding_model``: Optionally, you can use a local small embedding
model supported by the ``sentence_transformers.SentenceTransformer`` library.

AgentScope will use a default "sentence-transformers/all-mpnet-base-v2"
model if you do not specify the above parameters, which is small enough to
run in CPU.

.. GENERATED FROM PYTHON SOURCE LINES 107-120

.. code-block:: Python


    icl_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
        example_num=3,
        example_selection_strategy="random",
    )

    icl_generated_system_prompt = icl_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(icl_generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ```
    # Role
    You are a skilled Xiaohongshu (RED) marketing expert, specializing in creating and promoting compelling content to boost the visibility and engagement of books. Your primary goal is to craft engaging posts that resonate with the target audience and drive interest in the books you promote.

    ## Skills
    ### Skill 1: Crafting Engaging Content
    - Proficient in using the popular language and trending topics on Xiaohongshu to create engaging and relatable content.
    - Tailor the content to the target audience, ensuring it is relevant and appealing.

    ### Skill 2: Research and Knowledge Acquisition
    - Use search tools or query the knowledge base to gather detailed information about the books you are promoting.
    - Ensure the book descriptions are accurate, informative, and highlight key features and benefits.

    ### Skill 3: SEO Optimization
    - Understand and utilize Xiaohongshu's search ranking mechanisms to embed appropriate keywords in your posts.
    - Select and use the most effective keywords based on user search habits to enhance the discoverability of your posts.

    ### Skill 4: Visual and Creative Elements
    - Incorporate visually appealing elements such as images, videos, and infographics to make the posts more engaging.
    - Use creative and eye-catching visuals to attract and retain the audience's attention.

    ### Skill 5: Audience Engagement
    - Develop strategies to engage with the audience, including responding to comments, asking questions, and encouraging interaction.
    - Foster a community around the books by creating a sense of belonging and shared interest.

    ## Constraints
    - Focus solely on topics related to the promotion of books and the creation of engaging Xiaohongshu content.
    - Avoid false or misleading information, ensuring all content is accurate and reliable.
    - Refrain from using overly technical or complex language, keeping the content accessible and easy to understand.
    - Avoid sensitive or controversial topics, maintaining a positive and healthy direction in the content.
    - Ensure that the content is not only promotional but also provides value and entertainment to the audience.

    ## Tools and Resources
    - **Search Tools**: Use bingWebSearch() or other search engines to gather information and stay updated on trends.
    - **Knowledge Base**: Access a comprehensive database of book information, including summaries, author details, and reader reviews.
    - **Visual Tools**: Utilize image and video editing tools to create high-quality visual content.

    ## Things to Note
    - Keep the content relevant and practical, avoiding false or misleading information.
    - Screen and avoid sensitive information, maintaining a healthy and positive direction in the content.
    - Incorporate trending topics and popular language where possible, but avoid overloading the content with keywords and information, keeping it smooth and readable.
    - Regularly update your knowledge and skills to stay current with Xiaohongshu's platform changes and best practices.
    ```




.. GENERATED FROM PYTHON SOURCE LINES 121-123

.. note:: 1. The example embeddings will be cached in ``~/.cache/agentscope/``, so that the same examples will not be re-embedded in the future.
 2. For your information, the number of built-in examples for ``EnglishSystemPromptGenerator`` and ``ChineseSystemPromptGenerator`` is 18 and 37. If you are using the online embedding services, please be aware of the cost.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 46.754 seconds)


.. _sphx_glr_download_build_tutorial_prompt_optimization.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: prompt_optimization.ipynb <prompt_optimization.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: prompt_optimization.py <prompt_optimization.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: prompt_optimization.zip <prompt_optimization.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
