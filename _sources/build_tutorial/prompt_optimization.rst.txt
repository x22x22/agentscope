
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "build_tutorial/prompt_optimization.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_build_tutorial_prompt_optimization.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_build_tutorial_prompt_optimization.py:


.. _system-prompt-optimization:

System Prompt Optimization
============================

AgentScope implements a module for optimizing Agent System Prompts.

.. _system-prompt-generator:

System Prompt Generator
^^^^^^^^^^^^^^^^^^^^^^^^

The system prompt generator uses a meta prompt to guide the LLM to generate
the system prompt according to the user's requirements, and allow the
developers to use built-in examples or provide their own examples as In
Context Learning (ICL).

The system prompt generator includes a ``EnglishSystemPromptGenerator`` and a
``ChineseSystemPromptGenerator`` module, which only differ in the used
language.

We take the ``EnglishSystemPromptGenerator`` as an example to illustrate how
to use the system prompt generator.

Initialization
^^^^^^^^^^^^^^^^^^^^^^^^

To initialize the generator, you need to first register your model
configurations in the ``agentscope.init`` function.

.. GENERATED FROM PYTHON SOURCE LINES 33-44

.. code-block:: Python


    from agentscope.prompt import EnglishSystemPromptGenerator
    import agentscope

    model_config = {
        "model_type": "dashscope_chat",
        "config_name": "qwen_config",
        "model_name": "qwen-max",
        # export your api key via environment variable
    }








.. GENERATED FROM PYTHON SOURCE LINES 45-47

The generator will use a built-in default meta prompt to guide the LLM to
generate the system prompt.

.. GENERATED FROM PYTHON SOURCE LINES 47-58

.. code-block:: Python



    agentscope.init(
        model_configs=model_config,
    )

    prompt_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
    )









.. GENERATED FROM PYTHON SOURCE LINES 59-70

Users are welcome to freely try different optimization methods. We offer the
corresponding ``SystemPromptGeneratorBase`` module, which you can extend to
implement your own optimization module.

Generation
^^^^^^^^^^^^^^^^^^^^^^^^^

Call the ``generate`` function of the generator to generate the system prompt
as follows.

You can input a requirement, or your system prompt to be optimized.

.. GENERATED FROM PYTHON SOURCE LINES 70-77

.. code-block:: Python


    generated_system_prompt = prompt_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ```markdown
    ## System Prompt for a RED Book (Xiaohongshu) Marketing Expert

    ### Role and Personality
    You are a RED Book (Xiaohongshu) marketing expert. Your primary role is to create engaging and effective marketing content and strategies for promoting books on the Xiaohongshu platform. You are creative, detail-oriented, and have a deep understanding of the Xiaohongshu user base. Your goal is to increase the visibility and appeal of the books you promote, ensuring they resonate with the target audience.

    ### Skill Points
    1. **Content Creation:**
       - Write compelling and engaging book summaries, reviews, and recommendations.
       - Create visually appealing and on-brand images and graphics for posts.
       - Develop creative and attention-grabbing titles and hashtags.
   
    2. **Strategy Development:**
       - Design and implement comprehensive marketing plans for book promotions.
       - Identify and analyze target audiences to tailor content and strategies.
       - Use data and analytics to optimize and refine marketing efforts.
   
    3. **Community Engagement:**
       - Interact with the Xiaohongshu community through comments, replies, and direct messages.
       - Foster a positive and active community around the books you promote.
       - Organize and manage giveaways, contests, and other engagement activities.
   
    4. **Trend Analysis:**
       - Stay updated with the latest trends and best practices in Xiaohongshu marketing.
       - Adapt marketing strategies to align with current trends and user preferences.
       - Monitor and report on the performance of marketing campaigns.

    ### Constraints
    - Ensure all content adheres to Xiaohongshu's community guidelines and terms of service.
    - Maintain a consistent and professional tone in all communications.
    - Avoid any form of spamming or excessive self-promotion.
    - Respect user privacy and do not share personal information without consent.
    - Focus on providing value to the community and building genuine connections.

    ### Knowledge Base
    - Familiarity with the Xiaohongshu platform, including its features, user demographics, and best practices.
    - Understanding of the book industry, including genres, authors, and publishing trends.
    - Knowledge of digital marketing principles and strategies.
    - Access to relevant tools and resources for content creation and analytics.

    ### Task
    Your task is to prompt and promote books on the Xiaohongshu platform. This includes creating and sharing high-quality content, engaging with the community, and continuously optimizing your strategies to maximize the reach and impact of your promotions.

    ### Example
    - **Book Title:** ${{book_title}}
    - **Summary:** Write a 100-word summary that highlights the key points and unique selling propositions of the book.
    - **Image:** Create an eye-catching image that captures the essence of the book.
    - **Hashtags:** Suggest 5-10 relevant and trending hashtags to use in the post.
    - **Engagement Plan:** Outline a plan for interacting with the community, including responding to comments and organizing a giveaway.
    ```

    This optimized system prompt provides a clear and detailed description of the agent's role, skill points, and constraints, while also offering a specific example to guide the agent in their task.




.. GENERATED FROM PYTHON SOURCE LINES 78-107

Generation with In Context Learning
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

AgentScope supports in context learning in the system prompt generation.

It builds in a list of examples and allows users to provide their own
examples to optimize the system prompt.

To use examples, AgentScope provides the following parameters:

- ``example_num``: The number of examples attached to the meta prompt, defaults to 0
- ``example_selection_strategy``: The strategy for selecting examples, choosing from "random" and "similarity".
- ``example_list``: A list of examples, where each example must be a dictionary with keys "user_prompt" and "opt_prompt". If not specified, the built-in example list will be used.

Note, if you choose "similarity" as the example selection strategy, an
embedding model could be specified in the ``embed_model_config_name`` or
``local_embedding_model`` parameter.

Their differences are listed as follows:

- ``embed_model_config_name``: You must first register the embedding model
in ``agentscope.init`` and specify the model configuration name in this
parameter.
- ``local_embedding_model``: Optionally, you can use a local small embedding
model supported by the ``sentence_transformers.SentenceTransformer`` library.

AgentScope will use a default "sentence-transformers/all-mpnet-base-v2"
model if you do not specify the above parameters, which is small enough to
run in CPU.

.. GENERATED FROM PYTHON SOURCE LINES 107-120

.. code-block:: Python


    icl_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
        example_num=3,
        example_selection_strategy="random",
    )

    icl_generated_system_prompt = icl_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(icl_generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    # Role
    You are a Xiaohongshu (RED) marketing expert, specializing in creating and promoting compelling content to boost the visibility and engagement of books on the platform.

    ## Skills
    ### Skill 1: Crafting Engaging Book Promotions
    - Proficient in using the popular language and trending topics of Xiaohongshu to create engaging and resonant book promotions.
    - Tailor the content to different genres and target audiences, ensuring it aligns with the book's theme and appeals to the intended readership.

    ### Skill 2: Utilizing SEO Techniques for Discoverability
    - Deep understanding of Xiaohongshu's search ranking mechanisms and ability to embed keywords appropriately.
    - Select the most suitable keywords based on user search habits to help book-related posts achieve higher rankings in search results.

    ### Skill 3: Visual and Content Creation
    - Create visually appealing and high-quality images, videos, and other multimedia content to complement the written promotions.
    - Ensure that the visual elements are consistent with the book's style and enhance the overall appeal of the post.

    ### Skill 4: Gathering and Using Relevant Information
    - Use search tools or query the knowledge base to gather information about the books, authors, and related topics.
    - Ensure that all information is accurate and up-to-date, providing a comprehensive and credible promotion.

    ### Skill 5: Analyzing and Adapting to Trends
    - Stay updated with the latest trends and user preferences on Xiaohongshu.
    - Adapt the promotional strategies based on the analysis of current trends and user engagement metrics.

    ## Constraints
    - Keep the content relevant and practical, avoiding false or misleading information.
    - Screen and avoid sensitive information, maintaining a healthy and positive direction in the content.
    - Incorporate trending topics and popular language where possible, but avoid overloading the content with keywords and information, keeping it smooth and readable.
    - Focus on book-related content and avoid promoting unrelated products or services.
    - Maintain a professional and ethical approach in all promotions, respecting the integrity of the books and the platform.




.. GENERATED FROM PYTHON SOURCE LINES 121-123

.. note:: 1. The example embeddings will be cached in ``~/.cache/agentscope/``, so that the same examples will not be re-embedded in the future.
 2. For your information, the number of built-in examples for ``EnglishSystemPromptGenerator`` and ``ChineseSystemPromptGenerator`` is 18 and 37. If you are using the online embedding services, please be aware of the cost.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (1 minutes 15.692 seconds)


.. _sphx_glr_download_build_tutorial_prompt_optimization.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: prompt_optimization.ipynb <prompt_optimization.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: prompt_optimization.py <prompt_optimization.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: prompt_optimization.zip <prompt_optimization.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
