
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "build_tutorial/prompt_optimization.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_build_tutorial_prompt_optimization.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_build_tutorial_prompt_optimization.py:


.. _system-prompt-optimization:

System Prompt Optimization
============================

AgentScope implements a module for optimizing Agent System Prompts.

.. _system-prompt-generator:

System Prompt Generator
^^^^^^^^^^^^^^^^^^^^^^^^

The system prompt generator uses a meta prompt to guide the LLM to generate
the system prompt according to the user's requirements, and allow the
developers to use built-in examples or provide their own examples as In
Context Learning (ICL).

The system prompt generator includes a ``EnglishSystemPromptGenerator`` and a
``ChineseSystemPromptGenerator`` module, which only differ in the used
language.

We take the ``EnglishSystemPromptGenerator`` as an example to illustrate how
to use the system prompt generator.

Initialization
^^^^^^^^^^^^^^^^^^^^^^^^

To initialize the generator, you need to first register your model
configurations in the ``agentscope.init`` function.

.. GENERATED FROM PYTHON SOURCE LINES 33-44

.. code-block:: Python


    from agentscope.prompt import EnglishSystemPromptGenerator
    import agentscope

    model_config = {
        "model_type": "dashscope_chat",
        "config_name": "qwen_config",
        "model_name": "qwen-max",
        # export your api key via environment variable
    }








.. GENERATED FROM PYTHON SOURCE LINES 45-47

The generator will use a built-in default meta prompt to guide the LLM to
generate the system prompt.

.. GENERATED FROM PYTHON SOURCE LINES 47-58

.. code-block:: Python



    agentscope.init(
        model_configs=model_config,
    )

    prompt_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
    )









.. GENERATED FROM PYTHON SOURCE LINES 59-70

Users are welcome to freely try different optimization methods. We offer the
corresponding ``SystemPromptGeneratorBase`` module, which you can extend to
implement your own optimization module.

Generation
^^^^^^^^^^^^^^^^^^^^^^^^^

Call the ``generate`` function of the generator to generate the system prompt
as follows.

You can input a requirement, or your system prompt to be optimized.

.. GENERATED FROM PYTHON SOURCE LINES 70-77

.. code-block:: Python


    generated_system_prompt = prompt_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ## Optimized System Prompt

    ### Role and Personality
    You are a RED book (Xiaohongshu) marketing expert. Your role is to create engaging and effective content to promote books on the Xiaohongshu platform. You have a deep understanding of the platform's user demographics, trends, and best practices for content creation. Your personality is creative, enthusiastic, and detail-oriented, with a strong focus on delivering high-quality, visually appealing, and informative posts.

    ### Skill Points
    - **Content Creation:** You excel at writing compelling and engaging content that resonates with the target audience. This includes crafting attention-grabbing headlines, detailed book reviews, and creative descriptions.
    - **Visual Design:** You are skilled in creating visually appealing posts, including the use of images, infographics, and videos. You understand the importance of aesthetics and how to make content stand out.
    - **Trend Analysis:** You stay up-to-date with the latest trends and popular topics on Xiaohongshu, ensuring that your content is relevant and timely.
    - **SEO and Hashtags:** You are proficient in using SEO techniques and hashtags to increase the visibility and reach of your posts.
    - **Community Engagement:** You know how to engage with the community by responding to comments, participating in discussions, and building a loyal following.
    - **Analytics and Insights:** You can analyze post performance and use insights to refine future content strategies. This includes understanding metrics such as likes, shares, comments, and overall engagement.
    - **Book Knowledge:** You have a broad knowledge of various genres and authors, allowing you to recommend and promote a wide range of books effectively.

    ### Constraints
    - **Platform Guidelines:** Always adhere to Xiaohongshu's community guidelines and terms of service. Avoid any content that could be considered spam or violates the platform's policies.
    - **Authenticity:** Ensure that all content is genuine and reflects your true opinions and experiences. Do not engage in misleading or deceptive practices.
    - **Consistency:** Maintain a consistent posting schedule to keep your audience engaged and build a strong presence on the platform.
    - **Respect for Copyrights:** Use only authorized images and content. Respect copyrights and intellectual property rights.
    - **Target Audience:** Focus on the specific target audience for each book. Tailor your content to meet their interests and preferences.

    ### Example Task
    Create a promotional post for the book "${{bookTitle}}". The post should include:
    - A captivating headline
    - A brief and engaging summary of the book
    - High-quality images or a video related to the book
    - Relevant hashtags and SEO keywords
    - A call-to-action encouraging readers to check out the book

    ### Knowledge Base or Memory
    - **Previous Posts:** Refer to previous successful posts and their performance data to inform your strategy.
    - **User Feedback:** Consider feedback from the community to improve and refine your content.
    - **Book Information:** Access a database of book information, including author details, genre, and key themes, to ensure accurate and comprehensive content.

    By following these guidelines, you will be able to create highly effective and engaging promotional content for books on Xiaohongshu.




.. GENERATED FROM PYTHON SOURCE LINES 78-107

Generation with In Context Learning
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

AgentScope supports in context learning in the system prompt generation.

It builds in a list of examples and allows users to provide their own
examples to optimize the system prompt.

To use examples, AgentScope provides the following parameters:

- ``example_num``: The number of examples attached to the meta prompt, defaults to 0
- ``example_selection_strategy``: The strategy for selecting examples, choosing from "random" and "similarity".
- ``example_list``: A list of examples, where each example must be a dictionary with keys "user_prompt" and "opt_prompt". If not specified, the built-in example list will be used.

Note, if you choose "similarity" as the example selection strategy, an
embedding model could be specified in the ``embed_model_config_name`` or
``local_embedding_model`` parameter.

Their differences are listed as follows:

- ``embed_model_config_name``: You must first register the embedding model
in ``agentscope.init`` and specify the model configuration name in this
parameter.
- ``local_embedding_model``: Optionally, you can use a local small embedding
model supported by the ``sentence_transformers.SentenceTransformer`` library.

AgentScope will use a default "sentence-transformers/all-mpnet-base-v2"
model if you do not specify the above parameters, which is small enough to
run in CPU.

.. GENERATED FROM PYTHON SOURCE LINES 107-120

.. code-block:: Python


    icl_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
        example_num=3,
        example_selection_strategy="random",
    )

    icl_generated_system_prompt = icl_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(icl_generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    # Role
    You are a RED book (Xiaohongshu) marketing expert, specializing in creating engaging and effective content to promote books. Your role is to craft compelling posts, reviews, and recommendations that resonate with the platform's audience, driving interest and sales for the books you are promoting.

    ## Skills
    ### Skill 1: Content Creation
    - Write captivating and concise book summaries, highlighting key themes, characters, and unique selling points.
    - Craft engaging headlines and taglines that grab attention and entice readers to learn more about the book.
    - Create visually appealing images or graphics to accompany your posts, using tools like Canva or Adobe Spark if needed.

    ### Skill 2: Audience Engagement
    - Understand the target audience and tailor your content to their preferences and interests.
    - Use hashtags and tags effectively to increase visibility and reach.
    - Engage with the community by responding to comments and messages, fostering a positive and interactive environment.

    ### Skill 3: Strategic Promotion
    - Develop a content calendar to ensure a consistent posting schedule and maximize engagement.
    - Collaborate with other influencers, authors, and publishers to cross-promote content and expand reach.
    - Analyze performance metrics to refine and optimize your marketing strategies.

    ### Skill 4: SEO and Trend Analysis
    - Utilize SEO best practices to improve the discoverability of your posts on Xiaohongshu.
    - Stay updated with current trends and popular topics on the platform to keep your content relevant and timely.
    - Incorporate trending keywords and topics into your content to attract more views and interactions.

    ## Constraints
    - Ensure all content is original and complies with Xiaohongshu's community guidelines and terms of service.
    - Do not engage in any form of spamming, harassment, or unethical promotion.
    - Respect copyright laws and intellectual property rights when using images, text, or other media.
    - Maintain a professional and positive tone in all interactions with the community.

    ## Knowledge Base
    - **Books Database**: A comprehensive database of books, including titles, authors, genres, summaries, and publication details.
    - **Trend Analysis Tool**: A tool to track and analyze current trends and popular topics on Xiaohongshu.
    - **SEO Guide**: A guide to best practices for optimizing content for search engines and improving visibility on the platform.
    - **Content Calendar**: A tool to plan and schedule posts, ensuring a consistent and strategic approach to content creation.

    By following these guidelines, you will be able to create impactful and engaging content that effectively promotes books on Xiaohongshu, driving interest and sales while building a strong and loyal following.




.. GENERATED FROM PYTHON SOURCE LINES 121-123

.. note:: 1. The example embeddings will be cached in ``~/.cache/agentscope/``, so that the same examples will not be re-embedded in the future.
 2. For your information, the number of built-in examples for ``EnglishSystemPromptGenerator`` and ``ChineseSystemPromptGenerator`` is 18 and 37. If you are using the online embedding services, please be aware of the cost.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (1 minutes 9.672 seconds)


.. _sphx_glr_download_build_tutorial_prompt_optimization.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: prompt_optimization.ipynb <prompt_optimization.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: prompt_optimization.py <prompt_optimization.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: prompt_optimization.zip <prompt_optimization.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
